<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4"> <!-- Declaring  XML using-->

	<head th:replace="fragments.html :: headerfiles('砖专砖专')"></head>
	
	<body>
		
		<div th:replace="fragments.html :: topnav"></div>
		
		<br>
		
		<a th:href="@{/forum/} + ${topicInfo.topic.getForum().getId()}">专 驻专</a>

		<!-- TOPIC -->
		<table class="stretch" border="3" style="text-align:right; border-color: red">
			<colgroup>
		        <col width="20%">
		        <col width="20%">
		        <col width="20%">
		        <col width="20%">
		        <col width="20%">
	        </colgroup>
	        <tr>
	        	<td colspan="5">
					<h1 class="title overflow" th:text = "${topicInfo.topic.getTitle()}"> Title:>Topic name</h1>
	        	</td>
	        </tr>
	        <tr>
				<td colspan="1">
					<h3><a th:href="@{/user/} + ${topicInfo.topic.getUser().getUsername()}" th:text = "${topicInfo.topic.getUser().getUsername()}">Topic author</a></h3>
					<label>砖转砖:</label>
					<label th:text="${topicInfo.topic.getUser().getRole().getName()}"></label><br>
					<label>爪专祝 转专:</label>
					<label th:text="${topicInfo.topic.getUser().getFormattedJoiningDate()}"></label><br>
					<label>住驻专 注转:</label>
					<label th:text="${topicInfo.getTotalOfPosts()}"></label><br>
				</td>
				<td colspan="4">
					<p style="text-align: right" th:text = "'爪专 -:' + ${topicInfo.topic.getFormattedCreatedDate()}">Date</p>
					<pre class="indented postContent overflow" th:text = "${topicInfo.topic.getContent()}">Content</pre>
				</td>
			</tr>
	        <tr th:if="${#authentication.name} eq ${topicInfo.topic.user.username} or ${isAdmin}">
				<td colspan="5" style="text-align: left;">
					<a th:if="${#authentication.name} eq ${topicInfo.topic.user.username}" 
						th:href="@{/topic/edit/} + ${topicInfo.topic.getId()}" class = "button" >注专</a>
					<a th:href="@{/topic/delete/} + ${topicInfo.topic.getId()}" class = "button" >拽</a>
				</td>
			</tr>
		</table>
			
		<hr>
		
		<!-- Number of posts -->
		<header>
			<blockquote th:text="|转转: | + ${postsInfo.size()}">住驻专 转转</blockquote>
		</header>
		<hr>

		<!-- displaying all posts -->
		<div th:each = "postInfo: ${postsInfo}">
			<table class="stretch" border="1" style="text-align:right" th:id="${postInfo.post.getId()}">
				<colgroup>
			        <col width="20%">
			        <col width="20%">
			        <col width="20%">
			        <col width="20%">
			        <col width="20%">
		        </colgroup>
				<tr>
					<td colspan="1">
						<h3><a th:href="@{/user/} + ${postInfo.post.getUser().getUsername()}" th:text = "${postInfo.post.getUser().getUsername()}">Post author</a></h3>
						<label>砖转砖:</label>
						<label th:text="${postInfo.post.getUser().getRole().getName()}"></label><br>
						<label>爪专祝 转专:</label>
						<label th:text="${postInfo.post.getUser().getFormattedJoiningDate()}"></label><br>
						<label>住驻专 注转:</label>
						<label th:text="${postInfo.getTotalOfPosts()}"></label><br>
					</td>
					<td colspan="4">
						<p style="text-align: right" th:text = "'转 -:' + ${postInfo.post.getFormattedLastActivity()}">Date</p>
						<pre class="indented postContent overflow" th:text = "${postInfo.post.getContent()}">Content</pre>
					</td>
				</tr>
				<tr>
					<td colspan="5">
						<div style="display: flex; flex-direction:row; justify-content: flex-end;">
							<label th:text="${postInfo.post.getNumOfLikes()}"></label>
							<a  sec:authorize="isAnonymous()" th:href="@{/post/like/} + ${postInfo.post.getId()}" class = "button" style="pointer-events: none; cursor: default;"></a>
							<a sec:authorize="isAuthenticated()" th:href="@{/post/like/} + ${postInfo.post.getId()}" class = "button"></a>
							<div th:if="${#authentication.name} eq ${postInfo.post.getUser().getUsername()} or ${isAdmin}">
								<a th:if="${#authentication.name} eq ${postInfo.post.getUser().getUsername()}" 
									th:href="@{/post/edit/} + ${postInfo.post.getId()}" class = "button" >注专</a>
								<a th:href="@{/post/delete/} + ${postInfo.post.getId()}" class = "button" >拽</a>
							</div>
						</div>
					</td>
				</tr>
			</table>
			
			<br><br>
			
		</div>
	
		<!-- New Reply -->
		<section>
			<div sec:authorize="isAuthenticated()">
				<h3>住祝 转:</h3>
				<form th:action="@{/topic/} + ${topicInfo.topic.getId()}" method="POST" th:object="${post}">
					<textarea name="content" required></textarea>
					<input type="hidden" name="id_topic" th:value="${topicInfo.topic.getId()}"/>
					<input class="button" type="submit" value="砖" />
				</form>
			</div>
			<div sec:authorize="!isAuthenticated()">
				<h3><a th:href="@{/register}">专砖</a>  <a th:href="@{/login}">转专</a>  </h3>
	        </div>
		</section>
		
		<div th:replace="fragments.html :: botnav"></div>
		
	</body>
</html>