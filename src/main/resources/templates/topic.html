<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4"> <!-- Declaring  XML using-->

	<head th:replace="fragments.html :: headerfiles('שרשור')"></head>
	
	<body>
	
		<div th:replace="fragments.html :: topnav"></div>
		
		<br>
		
		<a th:href="@{/forum/} + ${topic.getForum().getId()}">חזרה לפורום</a>

		<!-- TOPIC -->
		<section>
			<h1 th:text = "${topic.getTitle()}"> Title:>Topic name</h1>
			<hr>
			
			<h2><a th:href="@{/user/} + ${topic.getUser().getUsername()}" th:text = "${topic.getUser().getUsername()} + ':'">Topic Author</a></h2>
			<p class="indented" th:text = "${topic.getContent()}">Content</p>
			
			<div th:if="${#authentication.name} eq ${topic.user.username}">
				<a class="button" th:href="@{/topic/edit/} + ${topic.id}">ערוך שרשור</a>
			</div>
		</section>
			
		<hr>
		
		<!-- Number of posts -->
		<header>
			<blockquote th:text="|תגובות: | + ${posts.size()}">מספר תגובות</blockquote>
		</header>
		<hr>
		
		<!-- displaying all posts -->
		<div th:each = "post: ${posts}">
			<div th:id="${post.getId()}">
				<section>
					<h3><a th:href="@{/user/} + ${post.getUser().getUsername()}" th:text = "${post.getUser().getUsername()} + ':'">Post author</a></h3>
					<p class="indented" th:text = "${post.getContent()}">Content</p>
				</section>
				<hr>
			</div>
		</div>
	
		<!-- New Reply -->
		<section>
			<div sec:authorize="isAuthenticated()">
				<h3>הוסף תגובה:</h3>
				<form th:action="@{/topic/} + ${topic.getId()}" method="POST" th:object="${post}">
					<textarea name="content" required></textarea>
					<input type="hidden" name="id_topic" th:value="${topic.getId()}"/>
					<input class="button" type="submit" value="שלח" />
				</form>
			</div>
			<div sec:authorize="!isAuthenticated()">
				<h3><a th:href="@{/register}">הירשם</a> או <a th:href="@{/login}">התחבר</a> כדי להגיב</h3>
	        </div>
		</section>
	</body>
</html>